<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="main.js"></script>
</head>
<body>
    <p id="debug" style="font-size: 24px;"></p>
    <canvas id="canvas" style="position: absolute; left: 50%; transform: translate(-50%, 0%)"></canvas>
    <img src="puyo_scaled.png" id="img" style="display: none">
    <script>

        let debug = document.getElementById("debug");
        debug.innerText += "outerWidth = " + window.outerWidth + "px\n";
        debug.innerText += "outerHeight = " + window.outerHeight + "px\n";

        let game;
        let size = 48;

        let canvas = document.getElementById("canvas");
        canvas.width = 7 * size;
        canvas.height = 10 * size;

        let ctx = canvas.getContext("2d");

        let img = document.getElementById("img");

        let sprites = [];


        img.addEventListener("load", function() {
            for(let y = 0; y < 5; y++) {
                let sprite = {};
                sprite.color = y;
                sprite.frames = [];
                for(let x = 0; x < 3; x++) {
                    ctx.clearRect(0, 0, size, size);
                    ctx.drawImage(img, x * 64, y * 64, 64, 64, 0, 0, size, size);
                    sprite.frames.push(ctx.getImageData(0, 0, size, size));
                }
                sprites.push(sprite);
            }

            game = Game(ctx, canvas.width, canvas.height, sprites);
        });

         

        canvas.addEventListener("click", function(e) {
            let x = e.pageX - canvas.offsetLeft;
            let y = e.pageY - canvas.offsetTop;
            game.click(x, y);
        });

    </script>
</body>
</html>